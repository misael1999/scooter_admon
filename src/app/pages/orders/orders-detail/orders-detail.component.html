<div class="container-fluid">
    <div class="row">
        <div class="containe">




            <div class="col-lg-12 d-flex justify-content-center" *ngIf="loadingOrder">
                <div class="spinner-border text-primary my-5" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>


            <h3 mat-dialog-title class="d-flex justify-content-between">
                <span>Pedido: <span class="text-primary">{{order.qr_code}}</span></span>
                <span>{{order.order_status.name}}</span>
                <span mat-dialog-close class="cursor"> <i class="anticon anticon-close"></i></span>

            </h3>


            <div class="row" *ngIf="!loadingOrder && order">
                <div class="col-md-12 col-lg-12 col-sm-12">
                    <div class="table-responsive">
                        <table class="table table-bordered table-sm">
                            <thead>
                                <tr>
                                    <th scope="col">Servicio</th>
                                    <th scope="col">Cliente</th>
                                    <th scope="col">Numero de cliente</th>
                                    <th scope="col">Repartidor</th>
                                    <th scope="col">Fecha del pedido</th>
                                    <th scope="col">Fecha de entrega</th>
                                    <th scope="col" *ngIf="order.service_id >= 1">Lugar de compra</th>
                                    <th scope="col" *ngIf="order.service_id >= 1">Lugar de entrega</th>
                                    <th scope="col">Distancia</th>

                                </tr>
                            </thead>

                            <tbody>
                                <tr>
                                    <td>
                                        <span *ngIf="order.service_id == 3" class="badge bg-secondary text-dark">Lo que sea</span>
                                        <span *ngIf="order.service_id == 2" class="badge bg-warning text-dark">{{order.service}}</span>
                                        <span *ngIf="order.service_id == 1" class="badge bg-info text-dark">{{order.service}}</span>
                                    </td>
                                    <td> {{ order.customer.name }} </td>
                                    <td> {{ order.customer.phone_number }} </td>
                                    <td>
                                        <span *ngIf="order.delivery_man"> {{ order.delivery_man.name }} </span>
                                        <span *ngIf="!order.delivery_man"> Sin repartidor </span>
                                    </td>

                                    <td> {{ order.order_date | date:'medium' }} </td>
                                    <td> {{ order.date_delivered_order | date:'medium'}} </td>
                                    <td *ngIf="order.service_id >= 1">


                                        <span *ngIf="order.is_order_to_merchant == true"> {{ order.merchant.merchant_name }} <br>                                
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item" style="color: #1890FF;"> <a (click)="openDirection(order.merchant_location)">Ver mapa </a> </li>
                                </ol>
                        </span>

                                        <span *ngIf="order.is_order_to_merchant == false"> {{ order.from_address.full_address }} <br>
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item" style="color: #1890FF;"> <a (click)="openDirection(order.from_address.point)">Ver mapa  </a> </li>
                                </ol>
                        </span>
                                    </td>
                                    <td> {{ order.to_address.full_address }} <br>
                                        <ol class="breadcrumb">
                                            <li class="breadcrumb-item" style="color: #1890FF;"> <a (click)="openDirection(order.to_address.point)">Ver mapa </a> </li>
                                        </ol>
                                    </td>

                                    <td> {{ order.distance | number }} KM</td>



                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>



                <div class="col-sm-12 col-md-12 col-lg-12 ">
                    <div class="table-responsive listCompras" *ngIf="order.service_id >= 1">
                        <table class="table table-bordered table-sm">
                            <thead>
                                <tr>
                                    <th style="width: 120px;" class="text-center">Cantidad</th>
                                    <th>Productos</th>
                                    <th style="width: 120px;" class="text-center">P. Unitario</th>
                                    <th style="width: 120px;" class="text-center">Total</th>
                                </tr>
                            </thead>

                            <tbody>
                                <tr *ngFor="let info of orderDetails">
                                    <th class="text-center menu"> {{ info.quantity }} </th>
                                    <td> <span class="menu"> {{ info.product_name }}</span>
                                        <div class="p-l-25" *ngFor="let menu of info.menu_options">
                                            <span class="interItem">{{ menu.menu_name }} </span>
                                            <table class="table table-border table-sm p-l-20">
                                                <thead>
                                                    <tr>
                                                        <td class="text-center" style="width: 100px;">Cantidad</td>
                                                        <td>Opcion</td>
                                                        <td *ngIf="menu.options.price_option > 0" style="width: 100px;">Precio</td>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let option of menu.options">
                                                        <td class="text-center interItem"> {{option.quantity}} </td>
                                                        <td class="interItem">{{ option.option_name}} </td>
                                                        <td class="interItem" *ngIf="menu.options.price_option > 0">{{ option.price_option }}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </td>
                                    <td class="text-center menu">$ {{ info.product_price }}</td>
                                    <td class="text-center menu">$ {{ info.total_detail }}</td>





                                    <tr>
                                        <th class="border-0"></th>
                                        <th colspan="2" class="totals border-0">ENVÍO:</th>
                                        <th class="text-center">$ {{order.service_price}} </th>
                                    </tr>
                                    <tr *ngIf="order.has_rate_operating == true">
                                        <th class="border-0"></th>
                                        <th colspan="2" class="totals border-0">COSTO OPERATIVO</th>
                                        <th class="text-center"> $ {{order.increment_price_operating}}</th>
                                    </tr>
                                    <tr>
                                        <th class="border-0"></th>
                                        <th colspan="2" class="totals border-0">TIPO DE PAGO:</th>
                                        <th class="text-center">
                                            <span *ngIf="order.is_payment_online == false"><u>EFECTIVO</u></span>
                                            <span *ngIf="order.is_payment_online == true"><u>TARJETA</u></span>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th class="border-0"></th>
                                        <th colspan="2" class="totals border-0">TOTAL:</th>
                                        <th class="text-center" *ngIf="order.total_order">
                                            <span *ngIf="order.service_id == 2" class="text-primary"> $ {{order.total_order}}</span>
                                            <span *ngIf="order.service_id == 3">
                                   
                                    
                                    </span>
                                        </th>
                                    </tr>

                            </tbody>
                        </table>
                    </div>












                    <table class="table table-hover table-bordered" *ngIf="order.service_id == 1">
                        <thead>
                            <tr>
                                <th scope="col">Se recoge</th>
                                <th scope="col">Indicaciones</th>
                                <th scope="col">Se Entrega</th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr>
                                <td>
                                    <span><small><strong>Alias</strong></small><br> {{ order.from_address.alias }} <br></span>
                                    <span *ngIf="order.from_address.exterior_number"><small><strong>Número Exterior</strong></small><br> {{order.from_address.exterior_number}} <br></span>
                                    <span *ngIf="order.from_address.inside_number"><small><strong>Número Interior</strong> </small><br> {{order.from_address.inside_number}} <br></span>
                                    <span><small><strong>Dirección</strong></small><br> {{ order.from_address.full_address }} </span>
                                </td>
                                <td> {{order.indications}} </td>
                                <td>
                                    <span><small><strong>Alias</strong></small><br> {{order.to_address.alias}} <br></span>
                                    <span *ngIf="order.to_address.exterior_number"><small><strong>Número Exterior</strong></small><br> {{order.to_address.exterior_number}} <br></span>
                                    <span *ngIf="order.to_address.inside_number"><small>Número Interior</small> {{order.to_address.inside_number}} <br></span>
                                    <span><small><strong>Dirección</strong></small><br> {{order.to_address.full_address}} </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
</div>